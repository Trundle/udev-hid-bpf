sources = [
    '10-FR-TEC-Raptor-Mach-2.bpf.c',
    '10-HP_Elite_Presenter.bpf.c',
    '10-Kaliber-MMOmentum.bpf.c',
    '10-Wacom-ArtPen.bpf.c',
    '10-XBox_Elite_2.bpf.c',
    '10-xppen-Artist24.bpf.c',
    '10-xppen-ArtistPro16Gen2.bpf.c',
]

foreach bpf : sources
    filter_matches = not have_filters
    if have_filters
        foreach filter: filters
            if bpf.contains(filter)
                filter_matches = true
                break
            endif
        endforeach
    endif
    bpf_sources += files(bpf)
    # This is a dummy target so meson thinks there's something here that
    # we can install. The actual files are generated by the cargo command
    # but adding a custom command here means we can install the files.
    bpf_o_files_testing += custom_target('fake-@0@.o'.format(bpf),
        input: bpf,
        depend_files: bpf,
        output: ['@BASENAME@.o'],
        command: ['true'],
        install: install_testing and filter_matches,
        install_dir: bpfdir,
    )
endforeach
